(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();const y=(e,n)=>{let t;return function(...r){clearTimeout(t),t=setTimeout(()=>{e instanceof Function&&e(...r)},n)}},h=async e=>{const n=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json"},redirect:"follow"});if(n.ok)return n.json();throw new Error("Something went wrong :(")},E=e=>{e.classList.remove("show")},p=(e,n=0)=>{const t=[];return e.forEach(r=>{const s=document.createElement("div");s.setAttribute("data-id",r.id.toString()),s.classList.add("suggests__item"),n===1&&s.classList.add("suggests__item_visited"),s.innerText=r.name,t.push(s)}),t},T=e=>{const n={},t=[];return e.forEach(r=>{n[r.name]=(n[r.name]||0)+1}),e.forEach(r=>{n[r.name]<2&&t.push(r)}),t},S="https://api.punkapi.com/v2/beers",w=10,v=async e=>h(`${S}?beer_name=${e}&per_page=${w}`),I=async e=>h(`${S}?ids=${e}&per_page=1`),l="visited",A=5,u=()=>{let e;const n="localStorage";try{e=window[n];const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(t.code===22||t.code===1014||t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&e.length!==0}},b=(e,n)=>{if(u())try{localStorage.setItem(e,JSON.stringify(n))}catch{localStorage.removeItem(e)}},_=e=>{if(!u())return[];const n=localStorage.getItem(e);if(n!==null)try{return JSON.parse(n)}catch{return[]}return[]},M=e=>{b(l,e)},m=()=>_(l),O=e=>{if(!u())return[];const n=_(l),t=[];for(let r=0;r<n.length;r++){const s=n[r];if(s.name.toLowerCase().search(e.toLowerCase())>-1&&(t.push(s),t.length>=A))return t}return t},d=document.querySelector("#search"),c=document.querySelector(".suggests"),a=document.querySelector(".result"),f=document.querySelector(".history__items"),g=e=>{f.innerHTML="";for(let n=0;n<Math.min(3,e.length);n++){const t=e[n],r=document.createElement("div");r.classList.add("history__item"),r.innerText=t.name,f.append(r)}},x=e=>{if(!a)return;a.classList.add("show"),a.innerHTML="";const n=document.createElement("h2");n.classList.add("result__title"),n.innerText=e.name,a.append(n);const t=document.createElement("div");t.classList.add("result__item");const r=document.createElement("img");r.classList.add("result__image"),r.setAttribute("src",e.image_url||""),t.append(r);const s=document.createElement("p");s.innerText=e.description,s.classList.add("result__description"),t.append(s),a.append(t)},N=async()=>{if(!d||!c)return;if(d.value===""){E(a);return}c.classList.contains("show")||c.classList.add("show"),c.innerHTML="",c.innerText="Loading...";let n=[];try{n=await v(d.value)}catch{c.innerText="Something went wrong :(";return}c.innerHTML="";const t=O(d.value),r=T([...t,...n]).splice(0,10-t.length);c==null||c.append(...p(t,1)),c==null||c.append(...p(r)),r.length===0&&t.length===0&&(c.innerText="No data to display :(")};d.addEventListener("keyup",y(N,400));c.addEventListener("click",async e=>{const n=e.target;if(n&&n.classList.contains("suggests__item")){const t=n.textContent,r=n.getAttribute("data-id");if(!r)return;const s=await I(r);x(s[0]);const o=m(),i=o.findIndex(L=>L.name===t);i>-1&&o.splice(i,1),o.unshift({name:t,id:r}),g(o),M(o)}});window.addEventListener("storage",()=>{const e=m();g(e)});window.addEventListener("DOMContentLoaded",()=>{g(m())});
